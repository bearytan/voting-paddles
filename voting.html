<!DOCTYPE html>
<html>
<head>
    <title>Voting</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>
</head>
<body>
    <h1>Vote for the Couple!</h1>
    <div id="votes"></div>
    <button onclick="vote('bride')">Vote for Bride</button>
    <button onclick="vote('groom')">Vote for Groom</button>
    <button onclick="resetVotes()" id="resetButton" style="display:none;">Reset Votes</button>

    <script>
       const firebaseConfig = {
  apiKey: "AIzaSyBngkD6yonIx2mI7oiC9BOfXBG-9PekVHE",
  authDomain: "wedding-game-8c6b9.firebaseapp.com",
  databaseURL: "https://wedding-game-8c6b9-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "wedding-game-8c6b9",
  storageBucket: "wedding-game-8c6b9.firebasestorage.app",
  messagingSenderId: "500082708201",
  appId: "1:500082708201:web:32d24f1167227f3e686a78"
};

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        let analytics; // Declare analytics variable

        if (firebaseConfig.measurementId) { // Only initialize analytics if measurementId is present
          analytics = firebase.getAnalytics(app);
        }

        const db = firebase.database(app);

        const votesRef = firebase.database().ref('votes');
        const votesDiv = document.getElementById("votes");
        const resetButton = document.getElementById("resetButton");
        let isAdmin = false;

        function updateVotes(votes) {
            votesDiv.innerHTML = "";
            for (const candidate in votes) {
                votesDiv.innerHTML += `<p>${candidate}: ${votes[candidate] || 0}</p>`;
            }
        }

        function vote(candidate) {
          votesRef.child(candidate).transaction(current_value => {
            return (current_value || 0) + 1;
          });
        }

        function resetVotes() {
            if (isAdmin) {
                votesRef.set({ bride: 0, groom: 0 });
            }
        }

        votesRef.on('value', (snapshot) => {
            const votes = snapshot.val() || { bride: 0, groom: 0};
            updateVotes(votes);
        });

        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('admin') === 'true') {
            isAdmin = true;
            resetButton.style.display = "block";
        }
    </script>
</body>
</html>
